@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ff: <https://foerderfunke.org/default#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix shn: <https://schemas.link/shacl-next#> .

ff:wfstp a ff:RequirementProfile ;
    ff:title "Wolfenbüttel Stiftung - Privatperson"@de , "Wolfenbüttel Foundation - Person"@en ;
    ff:category ff:stiftungs-foerderung ;
    ff:validationStage ff:preliminary-validation ;
    ff:tag ff:beta , ff:wolfenbuettel ;
    ff:benefitInfo "Die Wolfenbüttel-Stiftung unterstützt bedürftige Kinder, hilfsbedürftige und ältere Menschen in Wolfenbüttel – ohne Rechtsanspruch auf Förderung."@de ,
        "The Wolfenbüttel Foundation supports needy children and needy elderly people in Wolfenbüttel - without a legal claim to funding."@en ;
    rdfs:seeAlso <https://www.wolfenbuettel.de/index.php?ModID=7&FID=2672.9007.1&object=tx%7C2672.9007.1> ;
    ff:hasMainShape ff:wfstpMainShape ;
    ff:hasFlowShape ff:wfstpFlowShape .

# ----- EVALUATION LOGIC -----

ff:wfstpMainShape a sh:NodeShape ;
    sh:targetClass ff:Citizen ;

    sh:property [
        sh:path ff:hasResidence ;
        sh:in ( ff:hasResidence-wolfenbuettel  )
    ] ;

    sh:property [
        sh:path ff:financialDifficulty ;
        sh:in ( true )
    ] ;

    sh:property [
        sh:path ff:wbFoundationPreviousYear ;
        sh:in ( false ) ;
    ] .

# ----- DECISION TREE LOGIC -----

ff:wfstpFlowShape a sh:NodeShape ;
    sh:targetClass ff:Citizen ;

    sh:property ff:wfstpBaseRequirements ;
    sh:property ff:wbFoundationPreviousYearPS ;
    sh:property ff:wfstpLivesInWbPS .

ff:wfstpBaseRequirements a sh:PropertyShape ;    
    sh:property [ sh:path ff:hasResidence ; sh:minCount 1 ] .

ff:wfstpLivesInWbPS a sh:PropertyShape ;
    sh:deactivated [
        sh:not [
            sh:path ff:hasResidence ; sh:in ( ff:hasResidence-wolfenbuettel )
        ]
    ] ;
    sh:property [ sh:path ff:wbFoundationPreviousYear ; sh:minCount 1 ] ;
    sh:property [ sh:path ff:financialDifficulty ; sh:minCount 1 ] .
